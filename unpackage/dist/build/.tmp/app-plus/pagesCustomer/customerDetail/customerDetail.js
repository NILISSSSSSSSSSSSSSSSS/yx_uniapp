(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesCustomer/customerDetail/customerDetail"],{"165e":function(t,e,i){"use strict";var o,a=function(){var t=this,e=t.$createElement;t._self._c},n=[];i.d(e,"b",function(){return a}),i.d(e,"c",function(){return n}),i.d(e,"a",function(){return o})},"1f4e":function(t,e,i){"use strict";var o=i("9ae3"),a=i.n(o);a.a},2519:function(t,e,i){"use strict";(function(t,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i("3830"),n=i("5962"),s=i("a538"),u=i("2c59"),r=i("aea1"),c=i("3567"),l=i("2b2e"),d=i("b0ea"),h=i("64cf");function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var p=function(){return i.e("components/scrollLoading").then(i.bind(null,"b2e1"))},C=function(){return i.e("pagesCustomer/components/followList").then(i.bind(null,"5184"))},g=function(){return i.e("components/screenCustomer").then(i.bind(null,"23ed"))},w=function(){return i.e("components/screenCustomerOfDirectCustomer").then(i.bind(null,"6999"))},y={},v=function t(){f(this,t)};m(v,"isRequest",!1);var I={name:"customerDetail",components:{followList:C,screenCustomer:g,screenCustomerOfDirectCustomer:w,scrollLoading:p},onLoad:function(e){(new l.Notification).addObserver(this,"CustomerConfirmMsgChange",d.Notify.CustomerConfirmMsgChange.Name),console.log(t(e,"---c_param---"," at pagesCustomer\\customerDetail\\customerDetail.vue:372")),y={custId:e.custId,cityId:e.cityId,custName:e.custName},this.isNew=e.isNew||"0",this.source=e.source||"",e.custName&&o.setNavigationBarTitle({title:e.custName}),o.getSystemInfoSync().model.indexOf("iPhone X")>=0&&(this.isIphoneX=!0)},onUnload:function(){(new l.Notification).removeObserverAllNotification(this)},onShow:function(){v.isRequest=!1,this.iniData()},data:function(){return{source:"",isIphoneX:!1,isLoading:!0,accountSource:2,baseInfoList:{},brokerInfo:{},brokerFirstName:"",saleUInfo:{},saleFirstName:"",dealInfo:{},trackList:{},directCustomer:0,custStatus:-1e3,showButtonStatus:null,popupType:"",popupText:{yuYinTongHua:{title:"拨打电话",content:"",confirmText:"呼叫",cancelColor:"rgba(0,0,0,0.6)",confirmColor:"#3396fb"},wuXiaokehu:{title:"温馨提示",content:"是否确认为无效客户?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},queRenBaoBei:{title:"温馨提示",content:"是否确认报备?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},shenQinDaiKan:{title:"温馨提示",content:"是否申请带看?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},queRenDaiKan:{title:"温馨提示",content:"是否确认带看?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},queRenQianYue:{title:"温馨提示",content:"是否确认签约?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},shenQinJieYong:{title:"温馨提示",content:"是否申请结佣?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},shenQinQianYue:{title:"温馨提示",content:"是否申请签约?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},boDaDianHua:{title:"拨打电话",content:"",confirmText:"呼叫",cancelColor:"rgba(0,0,0,0.6)",confirmColor:"#3396fb"},jingJiRenBuQuanTips:{title:"温馨提示",content:"请联系经纪人补全客户电话",confirmText:"我知道了",confirmColor:"#3396fb",showCancel:!1},souceTips:{title:"温馨提示",content:"该客户尚未进行扫码确认，请先扫码确认再执行后续操作。",confirmText:"我知道了",confirmColor:"#3396fb",showCancel:!1}},detail_info:{},buQuanXinxi:!1,shangChuanDaiKanQueRenShu:!1,isShowKeDaiKanTimeText:!1,KeDaiKanDay:"",KeDaiKanHour:"",KeDaiKanMinute:"",isNew:0,isShowKeChenJiaoTimeText:!1,KeChenJiaoDay:"",KeChenJiaoHour:"",KeChenJiaoMinute:"",hasQueRenQianYue:!1,isShowCheXiaoRenGouView:!1,cheXiaoRenGouText:""}},methods:{CustomerConfirmMsgChange:function(){this.iniData()},iniData:function(){var e=this;y.custId&&y.cityId&&(this.isLoading=!0,new a.GetCustDetailInfo(y).send().then(function(i){var a=e;if(console.log(t(i,"--客户详情res--"," at pagesCustomer\\customerDetail\\customerDetail.vue:528")),200!=i.errCode)return e.DifferenceApi.showToast(i.errMsg||"服务器开小差了,请稍后再试"),[];i.data.custName&&o.setNavigationBarTitle({title:i.data.custName});var s={};if(s.custName=i.data.custName||"",s.custMobile=i.data.custMobile||"",s.custSex=i.data.custSex||"",s.intentionLayout=i.data.intentionLayout.split(",")||"",s.payWayCn=i.data.payWayCn||"",s.price=i.data.price||"",s.intentionRegion=i.data.intentionRegion||"",s.purchaseMotivation=i.data.purchaseMotivation||"",s.otherRequirement=i.data.otherRequirement||"",e.baseInfoList=s,s.isCanCall=!0,e.VerifyPhone(i.data.custMobile||"")&&(s.isCanCall=!1),e.brokerInfo=i.data.brokerInfo||[],e.brokerFirstName=i.data.brokerInfo&&i.data.brokerInfo.brokerName?i.data.brokerInfo.brokerName.substring(0,1):"",e.saleUInfo=i.data.saleUInfo||[],e.saleFirstName=i.data.saleUInfo&&i.data.saleUInfo.userName?i.data.saleUInfo.userName.substring(0,1):"",(new c.CustomerModel).setModel(i.data.saleUInfo||{}),i.data.trackList.length>0){var u=!0,r=!1,l=void 0;try{for(var d,h=i.data.trackList[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var f=d.value,m=/(\n)/g;f.trackContent=f.trackContent.replace(m,"#").split("#")}}catch(_){r=!0,l=_}finally{try{u||null==h.return||h.return()}finally{if(r)throw l}}}e.trackList=i.data.trackList||"",e.directCustomer=i.data.directCustomer,e.custStatus=i.data.custStatus;var p={};p.houseNo=i.data.houseNo||"",p.houseArea=i.data.houseArea||"",p.dealAmount=i.data.dealAmount||"",p.buildName=i.data.buildName||"",e.dealInfo=p,e.detail_info=i.data;var C=n.GetLoginModel.getUserJurisdiction();if(e.accountSource=n.GetLoginModel.getAccountSource(),e.showButtonStatus=null,"remind"==a.source&&i.data.custStatus&&2==i.data.custStatus){var g=function(){var t=Math.floor(w/1e3),e=Math.floor(t/86400)<0?0:Math.floor(t/86400);e<10&&(e="0"+e),a.KeDaiKanDay=e;var i=Math.floor(t%86400/3600)<0?0:Math.floor(t%86400/3600);i<10&&(i="0"+i),a.KeDaiKanHour=i;var o=Math.floor(t%86400%3600/60)<0?0:Math.floor(t%86400%3600/60);o<10&&(o="0"+o),a.KeDaiKanMinute=o,w-=6e4};e.showButtonStatus=203;var w=i.data.visitRemainingTime;return g(),setInterval(function(){g()},3e4),e.popupType="souceTips",void e.$refs.modal.show()}if(1==i.data.custStatus&&C.indexOf(1)>=0&&(e.showButtonStatus=101),2==i.data.custStatus&&(C.indexOf(2)>=0?(i.data.confirmationQrCodeTime?(e.showButtonStatus=201,e.buQuanXinxi=!!i.data.completeCustMobile,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):e.showButtonStatus=100,2==i.data.completeMobileConfig&&(e.showButtonStatus=204)):(i.data.confirmationQrCodeTime?(e.showButtonStatus=202,e.buQuanXinxi=!!i.data.completeCustMobile,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):e.showButtonStatus=100,2==i.data.completeMobileConfig&&(e.showButtonStatus=205)),"1"==e.isNew)){var y=function(){var t=Math.floor(v/1e3),e=Math.floor(t/86400)<0?0:Math.floor(t/86400);e<10&&(e="0"+e),a.KeDaiKanDay=e;var i=Math.floor(t%86400/3600)<0?0:Math.floor(t%86400/3600);i<10&&(i="0"+i),a.KeDaiKanHour=i;var o=Math.floor(t%86400%3600/60)<0?0:Math.floor(t%86400%3600/60);o<10&&(o="0"+o),a.KeDaiKanMinute=o,v-=6e4};e.showButtonStatus=203;var v=i.data.visitRemainingTime;y(),setInterval(function(){y()},3e4)}if(3==i.data.custStatus&&(C.indexOf(4)>=0&&(e.hasQueRenQianYue=!0),C.indexOf(3)>=0?(e.showButtonStatus=301,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):(e.showButtonStatus=302,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl),i.data.dealRemainingTime)){var I=function(){var t=Math.floor(S/1e3),e=Math.floor(t/86400)<0?0:Math.floor(t/86400);e<10&&(e="0"+e),a.KeChenJiaoDay=e;var i=Math.floor(t%86400/3600)<0?0:Math.floor(t%86400/3600);i<10&&(i="0"+i),a.KeChenJiaoHour=i;var o=Math.floor(t%86400%3600/60)<0?0:Math.floor(t%86400%3600/60);o<10&&(o="0"+o),a.KeChenJiaoMinute=o,S-=6e3};e.isShowKeChenJiaoTimeText=!0;var S=i.data.dealRemainingTime;I(),setInterval(function(){I()},3e4)}4==i.data.custStatus&&(C.indexOf(4)>=0?(e.showButtonStatus=401,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):(e.showButtonStatus=402,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl)),5==i.data.custStatus&&(0==i.data.userApply?(e.showButtonStatus=501,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):(e.showButtonStatus=502,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl),1==i.data.directCustomer&&(e.showButtonStatus=100)),6==i.data.custStatus&&(e.showButtonStatus=100,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl,1==i.data.directCustomer&&(e.showButtonStatus=100)),7!=i.data.custStatus&&1!=i.data.paidStatus||(1==i.data.directCustomer&&(e.showButtonStatus=100),e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl,e.showButtonStatus=701),console.log(t(e.custStatus,"当前用户状态"," at pagesCustomer\\customerDetail\\customerDetail.vue:791")),console.log(t(e.showButtonStatus,"当前block"," at pagesCustomer\\customerDetail\\customerDetail.vue:792"))}).catch(function(i){console.log(t(i," at pagesCustomer\\customerDetail\\customerDetail.vue:795")),e.DifferenceApi.showToast(i.errMsg||"服务器开小差了,请稍后再试")}))},goToAddFollowView:function(){o.navigateTo({url:"/pagesCustomer/writeFollow/writeFollow?custId="+y.custId+"&cityId="+y.cityId})},gotoButtonsView:function(e){if("invalidCustomerView"==e&&(this.popupType="wuXiaokehu",this.$refs.modal.show()),"checkReportView"==e&&(this.popupType="queRenBaoBei",this.$refs.modal.show()),"queRenDaiKanView"==e){if(1==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();this.popupType="queRenDaiKan",this.$refs.modal.show()}if("shenQinDaiKanView"==e&&(this.popupType="shenQinDaiKan",this.$refs.modal.show()),"ckeckRenGouView"==e){if(2==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();var i=this.detail_info.cityId||"",a=this.detail_info.custId||"",n=this.detail_info.custStatus||"",s=this.detail_info.houseNo||"",u=this.detail_info.houseArea||"",r=this.detail_info.dealAmount||"",c=this.detail_info.commission||"",l=this.detail_info.directCustomer||0,d=this.detail_info.layoutNo||"";o.navigateTo({url:"/pagesCustomer/subscriptionInfo/subscriptionInfo?houseNo="+s+"&houseArea="+u+"&dealAmount="+r+"&commission="+c+"&cityId="+i+"&custId="+a+"&custStatus="+n+"&directCustomer="+l+"&layoutNo="+d})}if("queRenQianYueView"==e){if(2==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();if(this.detail_info.houseNo&&this.detail_info.houseArea&&this.detail_info.dealAmount&&this.detail_info.layoutNo)this.popupType="queRenQianYue",this.$refs.modal.show();else{var h=this.detail_info.cityId||"",f=this.detail_info.custId||"",m=this.detail_info.custStatus||"",p=this.detail_info.directCustomer||0;o.navigateTo({url:"/pagesCustomer/signInfo/signInfo?cityId="+h+"&custId="+f+"&custStatus="+m+"&directCustomer="+p})}}if("applyRenGouView"==e){if(2==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();var C=this.detail_info.cityId||"",g=this.detail_info.custId||"",w=this.detail_info.custStatus||"",y=this.detail_info.houseNo||"",v=this.detail_info.houseArea||"",I=this.detail_info.dealAmount||"",S=this.detail_info.commission||"",_=this.detail_info.layoutNo||"",D=this.detail_info.directCustomer||0;o.navigateTo({url:"/pagesCustomer/applyRenGou/applyRenGou?houseNo="+y+"&houseArea="+v+"&dealAmount="+I+"&commission="+S+"&cityId="+C+"&custId="+g+"&custStatus="+w+"&directCustomer="+D+"&layoutNo="+_})}if("shenQinQianYueView"==e){if(2==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();if(this.detail_info.houseNo&&this.detail_info.houseArea&&this.detail_info.dealAmount&&this.detail_info.layoutNo)this.popupType="shenQinQianYue",this.$refs.modal.show();else{var b=this.detail_info.cityId||"",T=this.detail_info.custId||"",R=this.detail_info.custStatus||"",M=this.detail_info.layoutNo||"",N=this.detail_info.directCustomer||0;o.navigateTo({url:"/pagesCustomer/signInfo/signInfo?cityId="+b+"&custId="+T+"&custStatus="+R+"&directCustomer="+N+"&layoutNo="+M})}}if("cheXiaoRenGouView"==e&&(this.isShowCheXiaoRenGouView=!0,console.log(t("撤销认购"," at pagesCustomer\\customerDetail\\customerDetail.vue:950"))),"shenQinJieYongView"==e&&(this.popupType="shenQinJieYong",this.$refs.modal.show()),"upDaiKanQueRenShuView"==e){console.log(t("点击上传带看确认书按钮了"," at pagesCustomer\\customerDetail\\customerDetail.vue:959"));var K=this.detail_info.confirmationPhotoUrl||"";o.navigateTo({url:"/pagesCustomer/upDaiKanQueRenShu/upDaiKanQueRenShu?brokerCityId="+this.detail_info.cityId+"&custId="+this.detail_info.custId+"&photoUrl="+K+"&paidStatus="+this.detail_info.paidStatus+"&custStatus="+this.detail_info.custStatus})}},onModalChanged:function(t){var e=this;if(t){if("wuXiaokehu"==this.popupType){var i={custId:this.detail_info.custId,cityId:this.detail_info.cityId,custStatus:0};this.UpdateCustStatus(i)}if("queRenBaoBei"==this.popupType){var a={custId:this.detail_info.custId,cityId:this.detail_info.cityId,custStatus:2};this.UpdateCustStatus(a)}if("queRenDaiKan"==this.popupType){var n=(new c.CustomerModel).getModel()||"";n.userId&&(new h.ImSendMessage).sendNotifyMsg("ld_"+n.userId);var u={custId:this.detail_info.custId,cityId:this.detail_info.cityId,custStatus:3};this.UpdateCustStatus(u)}if("shenQinDaiKan"==this.popupType){var l={custId:this.detail_info.custId,cityId:this.detail_info.cityId};this.ApplyCustomer(l)}if("shenQinJieYong"==this.popupType){var d={custId:this.detail_info.custId,cityId:this.detail_info.cityId};this.ApplyCustomer(d)}if("queRenQianYue"==this.popupType){if(v.isRequest)return;o.showLoading({title:"确认中"});var f={cityId:this.detail_info.cityId,custId:this.detail_info.custId,custStatus:this.detail_info.custStatus,houseNo:this.detail_info.houseNo,houseArea:this.detail_info.houseArea,dealAmount:this.detail_info.dealAmount,layoutNo:this.detail_info.layoutNo||"",commission:this.detail_info.commission||""};v.isRequest=!0,new r.RequestOrSign(f).send().then(function(t){if(o.hideLoading(),t.errCode!==s.Const.success)return e.DifferenceApi.showToast(t.errMsg||"服务器开小差了,请稍后再试"),void(v.isRequest=!1);v.isRequest=!1,e.iniData()}).catch(function(t){o.hideLoading(),v.isRequest=!1,e.DifferenceApi.showToast(t.errMsg||"请求失败")})}if("boDaDianHua"==this.popupType&&o.makePhoneCall({phoneNumber:this.detail_info.custMobile}),"shenQinQianYue"==this.popupType){if(v.isRequest)return;o.showLoading({title:"申请中"});var m={cityId:this.detail_info.cityId,custId:this.detail_info.custId,custStatus:this.detail_info.custStatus,houseNo:this.detail_info.houseNo,houseArea:this.detail_info.houseArea,dealAmount:this.detail_info.dealAmount,commission:this.detail_info.commission||"",layoutNo:this.detail_info.layoutNo||""};v.isRequest=!0,new r.RequestOrSign(m).send().then(function(t){if(o.hideLoading(),t.errCode!==s.Const.success)return e.DifferenceApi.showToast(t.errMsg||"服务器开小差了,请稍后再试"),void(v.isRequest=!1);v.isRequest=!1,e.iniData()}).catch(function(t){o.hideLoading(),v.isRequest=!1,e.DifferenceApi.showToast(t.errMsg||"请求失败")})}}},UpdateCustStatus:function(t){var e=this;v.isRequest||(o.showLoading({title:"操作中"}),v.isRequest=!0,new a.UpdateCustStatus(t).send().then(function(t){if(o.hideLoading(),200!=t.errCode)return e.DifferenceApi.showToast(t.errMsg||"服务器开小差了,请稍后再试"),void(v.isRequest=!1);v.isRequest=!1,e.iniData()}).catch(function(t){v.isRequest=!1,o.hideLoading(),e.DifferenceApi.showToast(t.errMsg||"请求失败")}))},ApplyCustomer:function(t){var e=this;v.isRequest||(o.showLoading({title:"操作中"}),v.isRequest=!0,new a.ApplyNextStep(t).send().then(function(t){if(o.hideLoading(),200!=t.errCode)return v.isRequest=!1,void e.DifferenceApi.showToast(t.errMsg||"服务器开小差了,请稍后再试");v.isRequest=!1,e.iniData()}).catch(function(t){v.isRequest=!1,o.hideLoading(),e.DifferenceApi.showToast(t.errMsg||"请求失败")}))},cancelCeXiao:function(){console.log(t("取消 撤销认购 页面展示"," at pagesCustomer\\customerDetail\\customerDetail.vue:1146")),this.isShowCheXiaoRenGouView=!1},changeTextArea:function(t){this.cheXiaoRenGouText=t.detail.value},quedinCeXiao:function(){var t=this;if(0!=this.cheXiaoRenGouText.length){var e={cityId:this.detail_info.cityId,custId:this.detail_info.custId,reason:this.cheXiaoRenGouText};o.showLoading({title:"撤销中...",mask:u.Config.mask}),new r.CancelConfirm(e).send().then(function(e){if(o.hideLoading(),e.errCode!==s.Const.success)return Promise.reject(e);t.isShowCheXiaoRenGouView=!1,t.iniData(),t.DifferenceApi.showToast("撤销认购成功")}).catch(function(e){o.hideLoading(),t.DifferenceApi.showToast(e.errMsg||"请求失败")})}else this.DifferenceApi.showToast("请输入撤销原因")},VerifyPhone:function(t){if(!t)return!1;var e=/[*]+/;return!!e.test(t)},goToCallPhoneView:function(t){t?11===t.length?(this.popupType="boDaDianHua",this.popupText.boDaDianHua.content=t,this.$refs.modal.show()):this.DifferenceApi.showToast("电话号码错误"):this.DifferenceApi.showToast("暂无电话")}}};e.default=I}).call(this,i("0de9")["default"],i("6e42")["default"])},"2d6f":function(t,e,i){"use strict";i.r(e);var o=i("165e"),a=i("90dd");for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);i("1f4e");var s,u=i("f0c5"),r=Object(u["a"])(a["default"],o["b"],o["c"],!1,null,"214977c4",null,!1,o["a"],s);e["default"]=r.exports},"90dd":function(t,e,i){"use strict";i.r(e);var o=i("2519"),a=i.n(o);for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);e["default"]=a.a},"990c":function(t,e,i){"use strict";(function(t){i("3ea8"),i("921b");o(i("66fd"));var e=o(i("2d6f"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])},"9ae3":function(t,e,i){}},[["990c","common/runtime","common/vendor"]]]);