(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesCustomer/customerDetail/customerDetail"],{"1b53":function(t,e,i){"use strict";var o=i("a236"),a=i.n(o);a.a},"2a69":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i("3d98"),a=i("6594"),n=i("a0ec"),s=i("8c03"),u=i("22d5"),r=i("eb5b"),c=i("baf9"),d=i("10c9"),h=i("451a");function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var p=function(){return i.e("components/scrollLoading").then(i.bind(null,"d59e"))},m=function(){return i.e("pagesCustomer/components/followList").then(i.bind(null,"5b9a"))},C=function(){return i.e("components/screenCustomer").then(i.bind(null,"ea18"))},g=function(){return i.e("components/screenCustomerOfDirectCustomer").then(i.bind(null,"8954"))},w={},y=function t(){l(this,t)};f(y,"isRequest",!1);var b={name:"customerDetail",components:{followList:m,screenCustomer:C,screenCustomerOfDirectCustomer:g,scrollLoading:p},onLoad:function(e){(new c.Notification).addObserver(this,"CustomerConfirmMsgChange",d.Notify.CustomerConfirmMsgChange.Name),console.log(e,"---c_param---"),w={custId:e.custId,cityId:e.cityId,custName:e.custName},this.isNew=e.isNew||"0",e.custName&&t.setNavigationBarTitle({title:e.custName}),t.getSystemInfoSync().model.indexOf("iPhone X")>=0&&(this.isIphoneX=!0)},onUnload:function(){(new c.Notification).removeObserverAllNotification(this)},onShow:function(){y.isRequest=!1,this.iniData()},data:function(){return{isIphoneX:!1,isLoading:!0,accountSource:2,baseInfoList:{},brokerInfo:{},brokerFirstName:"",saleUInfo:{},saleFirstName:"",dealInfo:{},trackList:{},directCustomer:0,custStatus:-1e3,showButtonStatus:null,popupType:"",popupText:{yuYinTongHua:{title:"拨打电话",content:"",confirmText:"呼叫",cancelColor:"rgba(0,0,0,0.6)",confirmColor:"#3396fb"},wuXiaokehu:{title:"温馨提示",content:"是否确认为无效客户?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},queRenBaoBei:{title:"温馨提示",content:"是否确认报备?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},shenQinDaiKan:{title:"温馨提示",content:"是否申请带看?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},queRenDaiKan:{title:"温馨提示",content:"是否确认带看?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},queRenQianYue:{title:"温馨提示",content:"是否确认签约?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},shenQinJieYong:{title:"温馨提示",content:"是否申请结佣?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},shenQinQianYue:{title:"温馨提示",content:"是否申请签约?",confirmText:"确认",cancelColor:"#3396fb",confirmColor:"#3396fb"},boDaDianHua:{title:"拨打电话",content:"",confirmText:"呼叫",cancelColor:"rgba(0,0,0,0.6)",confirmColor:"#3396fb"},jingJiRenBuQuanTips:{title:"温馨提示",content:"请联系经纪人补全客户电话",confirmText:"我知道了",confirmColor:"#3396fb",showCancel:!1}},detail_info:{},buQuanXinxi:!1,shangChuanDaiKanQueRenShu:!1,isShowKeDaiKanTimeText:!1,KeDaiKanDay:"",KeDaiKanHour:"",KeDaiKanMinute:"",isNew:0,isShowKeChenJiaoTimeText:!1,KeChenJiaoDay:"",KeChenJiaoHour:"",KeChenJiaoMinute:"",hasQueRenQianYue:!1,isShowCheXiaoRenGouView:!1,cheXiaoRenGouText:""}},methods:{CustomerConfirmMsgChange:function(){this.iniData()},iniData:function(){var e=this;w.custId&&w.cityId&&(this.isLoading=!0,new o.GetCustDetailInfo(w).send().then(function(i){var o=e;if(console.log(i,"--客户详情res--"),200!=i.errCode)return e.DifferenceApi.showToast(i.errMsg||"服务器开小差了,请稍后再试"),[];i.data.custName&&t.setNavigationBarTitle({title:i.data.custName});var n={};if(n.custName=i.data.custName||"",n.custMobile=i.data.custMobile||"",n.custSex=i.data.custSex||"",n.intentionLayout=i.data.intentionLayout.split(",")||"",n.payWayCn=i.data.payWayCn||"",n.price=i.data.price||"",n.intentionRegion=i.data.intentionRegion||"",n.purchaseMotivation=i.data.purchaseMotivation||"",n.otherRequirement=i.data.otherRequirement||"",e.baseInfoList=n,n.isCanCall=!0,e.VerifyPhone(i.data.custMobile||"")&&(n.isCanCall=!1),e.brokerInfo=i.data.brokerInfo||[],e.brokerFirstName=i.data.brokerInfo&&i.data.brokerInfo.brokerName?i.data.brokerInfo.brokerName.substring(0,1):"",e.saleUInfo=i.data.saleUInfo||[],e.saleFirstName=i.data.saleUInfo&&i.data.saleUInfo.userName?i.data.saleUInfo.userName.substring(0,1):"",(new r.CustomerModel).setModel(i.data.saleUInfo||{}),i.data.trackList.length>0){var s=!0,u=!1,c=void 0;try{for(var d,h=i.data.trackList[Symbol.iterator]();!(s=(d=h.next()).done);s=!0){var l=d.value,f=/(\n)/g;l.trackContent=l.trackContent.replace(f,"#").split("#")}}catch(b){u=!0,c=b}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}}e.trackList=i.data.trackList||"",e.directCustomer=i.data.directCustomer,e.custStatus=i.data.custStatus;var p={};p.houseNo=i.data.houseNo||"",p.houseArea=i.data.houseArea||"",p.dealAmount=i.data.dealAmount||"",p.buildName=i.data.buildName||"",e.dealInfo=p,e.detail_info=i.data;var m=a.GetLoginModel.getUserJurisdiction();if(e.accountSource=a.GetLoginModel.getAccountSource(),e.showButtonStatus=null,1==i.data.custStatus&&m.indexOf(1)>=0&&(e.showButtonStatus=101),2==i.data.custStatus&&(m.indexOf(2)>=0?(i.data.confirmationQrCodeTime?(e.showButtonStatus=201,e.buQuanXinxi=!!i.data.completeCustMobile,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):e.showButtonStatus=100,2==i.data.completeMobileConfig&&(e.showButtonStatus=204)):(i.data.confirmationQrCodeTime?(e.showButtonStatus=202,e.buQuanXinxi=!!i.data.completeCustMobile,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):e.showButtonStatus=100,2==i.data.completeMobileConfig&&(e.showButtonStatus=205)),"1"==e.isNew)){var C=function(){var t=Math.floor(g/1e3),e=Math.floor(t/86400)<0?0:Math.floor(t/86400);e<10&&(e="0"+e),o.KeDaiKanDay=e;var i=Math.floor(t%86400/3600)<0?0:Math.floor(t%86400/3600);i<10&&(i="0"+i),o.KeDaiKanHour=i;var a=Math.floor(t%86400%3600/60)<0?0:Math.floor(t%86400%3600/60);a<10&&(a="0"+a),o.KeDaiKanMinute=a,g-=6e4};e.showButtonStatus=203;var g=i.data.visitRemainingTime;C(),setInterval(function(){C()},3e4)}if(3==i.data.custStatus&&(m.indexOf(4)>=0&&(e.hasQueRenQianYue=!0),m.indexOf(3)>=0?(e.showButtonStatus=301,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):(e.showButtonStatus=302,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl),i.data.dealRemainingTime)){var w=function(){var t=Math.floor(y/1e3),e=Math.floor(t/86400)<0?0:Math.floor(t/86400);e<10&&(e="0"+e),o.KeChenJiaoDay=e;var i=Math.floor(t%86400/3600)<0?0:Math.floor(t%86400/3600);i<10&&(i="0"+i),o.KeChenJiaoHour=i;var a=Math.floor(t%86400%3600/60)<0?0:Math.floor(t%86400%3600/60);a<10&&(a="0"+a),o.KeChenJiaoMinute=a,y-=6e3};e.isShowKeChenJiaoTimeText=!0;var y=i.data.dealRemainingTime;w(),setInterval(function(){w()},3e4)}4==i.data.custStatus&&(m.indexOf(4)>=0?(e.showButtonStatus=401,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):(e.showButtonStatus=402,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl)),5==i.data.custStatus&&(0==i.data.userApply?(e.showButtonStatus=501,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl):(e.showButtonStatus=502,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl),1==i.data.directCustomer&&(e.showButtonStatus=100)),6==i.data.custStatus&&(e.showButtonStatus=100,e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl,1==i.data.directCustomer&&(e.showButtonStatus=100)),7!=i.data.custStatus&&1!=i.data.paidStatus||(1==i.data.directCustomer&&(e.showButtonStatus=100),e.shangChuanDaiKanQueRenShu=!!i.data.confirmationPhotoUrl,e.showButtonStatus=701),console.log(e.custStatus,"当前用户状态"),console.log(e.showButtonStatus,"当前block")}).catch(function(t){console.log(t),e.DifferenceApi.showToast(t.errMsg||"服务器开小差了,请稍后再试")}))},goToAddFollowView:function(){t.navigateTo({url:"/pagesCustomer/writeFollow/writeFollow?custId="+w.custId+"&cityId="+w.cityId})},gotoButtonsView:function(e){if("invalidCustomerView"==e&&(this.popupType="wuXiaokehu",this.$refs.modal.show()),"checkReportView"==e&&(this.popupType="queRenBaoBei",this.$refs.modal.show()),"queRenDaiKanView"==e){if(1==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();this.popupType="queRenDaiKan",this.$refs.modal.show()}if("shenQinDaiKanView"==e&&(this.popupType="shenQinDaiKan",this.$refs.modal.show()),"ckeckRenGouView"==e){if(2==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();var i=this.detail_info.cityId||"",o=this.detail_info.custId||"",a=this.detail_info.custStatus||"",n=this.detail_info.houseNo||"",s=this.detail_info.houseArea||"",u=this.detail_info.dealAmount||"",r=this.detail_info.commission||"",c=this.detail_info.directCustomer||0,d=this.detail_info.layoutNo||"";t.navigateTo({url:"/pagesCustomer/subscriptionInfo/subscriptionInfo?houseNo="+n+"&houseArea="+s+"&dealAmount="+u+"&commission="+r+"&cityId="+i+"&custId="+o+"&custStatus="+a+"&directCustomer="+c+"&layoutNo="+d})}if("queRenQianYueView"==e){if(2==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();if(this.detail_info.houseNo&&this.detail_info.houseArea&&this.detail_info.dealAmount&&this.detail_info.layoutNo)this.popupType="queRenQianYue",this.$refs.modal.show();else{var h=this.detail_info.cityId||"",l=this.detail_info.custId||"",f=this.detail_info.custStatus||"",p=this.detail_info.directCustomer||0;t.navigateTo({url:"/pagesCustomer/signInfo/signInfo?cityId="+h+"&custId="+l+"&custStatus="+f+"&directCustomer="+p})}}if("applyRenGouView"==e){if(2==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();var m=this.detail_info.cityId||"",C=this.detail_info.custId||"",g=this.detail_info.custStatus||"",w=this.detail_info.houseNo||"",y=this.detail_info.houseArea||"",b=this.detail_info.dealAmount||"",I=this.detail_info.commission||"",_=this.detail_info.layoutNo||"",S=this.detail_info.directCustomer||0;t.navigateTo({url:"/pagesCustomer/applyRenGou/applyRenGou?houseNo="+w+"&houseArea="+y+"&dealAmount="+b+"&commission="+I+"&cityId="+m+"&custId="+C+"&custStatus="+g+"&directCustomer="+S+"&layoutNo="+_})}if("shenQinQianYueView"==e){if(2==this.detail_info.completeMobileConfig&&0==this.detail_info.completeCustMobile&&0==this.detail_info.directCustomer)return this.popupType="jingJiRenBuQuanTips",void this.$refs.modal.show();if(this.detail_info.houseNo&&this.detail_info.houseArea&&this.detail_info.dealAmount&&this.detail_info.layoutNo)this.popupType="shenQinQianYue",this.$refs.modal.show();else{var T=this.detail_info.cityId||"",v=this.detail_info.custId||"",R=this.detail_info.custStatus||"",D=this.detail_info.layoutNo||"",M=this.detail_info.directCustomer||0;t.navigateTo({url:"/pagesCustomer/signInfo/signInfo?cityId="+T+"&custId="+v+"&custStatus="+R+"&directCustomer="+M+"&layoutNo="+D})}}if("cheXiaoRenGouView"==e&&(this.isShowCheXiaoRenGouView=!0,console.log("撤销认购")),"shenQinJieYongView"==e&&(this.popupType="shenQinJieYong",this.$refs.modal.show()),"upDaiKanQueRenShuView"==e){console.log("点击上传带看确认书按钮了");var N=this.detail_info.confirmationPhotoUrl||"";t.navigateTo({url:"/pagesCustomer/upDaiKanQueRenShu/upDaiKanQueRenShu?brokerCityId="+this.detail_info.cityId+"&custId="+this.detail_info.custId+"&photoUrl="+N+"&paidStatus="+this.detail_info.paidStatus+"&custStatus="+this.detail_info.custStatus})}},onModalChanged:function(e){var i=this;if(e){if("wuXiaokehu"==this.popupType){var o={custId:this.detail_info.custId,cityId:this.detail_info.cityId,custStatus:0};this.UpdateCustStatus(o)}if("queRenBaoBei"==this.popupType){var a={custId:this.detail_info.custId,cityId:this.detail_info.cityId,custStatus:2};this.UpdateCustStatus(a)}if("queRenDaiKan"==this.popupType){var s=(new r.CustomerModel).getModel()||"";s.userId&&(new h.ImSendMessage).sendNotifyMsg("ld_"+s.userId);var c={custId:this.detail_info.custId,cityId:this.detail_info.cityId,custStatus:3};this.UpdateCustStatus(c)}if("shenQinDaiKan"==this.popupType){var d={custId:this.detail_info.custId,cityId:this.detail_info.cityId};this.ApplyCustomer(d)}if("shenQinJieYong"==this.popupType){var l={custId:this.detail_info.custId,cityId:this.detail_info.cityId};this.ApplyCustomer(l)}if("queRenQianYue"==this.popupType){if(y.isRequest)return;t.showLoading({title:"确认中"});var f={cityId:this.detail_info.cityId,custId:this.detail_info.custId,custStatus:this.detail_info.custStatus,houseNo:this.detail_info.houseNo,houseArea:this.detail_info.houseArea,dealAmount:this.detail_info.dealAmount,layoutNo:this.detail_info.layoutNo||"",commission:this.detail_info.commission||""};y.isRequest=!0,new u.RequestOrSign(f).send().then(function(e){if(t.hideLoading(),e.errCode!==n.Const.success)return i.DifferenceApi.showToast(e.errMsg||"服务器开小差了,请稍后再试"),void(y.isRequest=!1);y.isRequest=!1,i.iniData()}).catch(function(e){t.hideLoading(),y.isRequest=!1,i.DifferenceApi.showToast(e.errMsg||"请求失败")})}if("boDaDianHua"==this.popupType&&t.makePhoneCall({phoneNumber:this.detail_info.custMobile}),"shenQinQianYue"==this.popupType){if(y.isRequest)return;t.showLoading({title:"申请中"});var p={cityId:this.detail_info.cityId,custId:this.detail_info.custId,custStatus:this.detail_info.custStatus,houseNo:this.detail_info.houseNo,houseArea:this.detail_info.houseArea,dealAmount:this.detail_info.dealAmount,commission:this.detail_info.commission||"",layoutNo:this.detail_info.layoutNo||""};y.isRequest=!0,new u.RequestOrSign(p).send().then(function(e){if(t.hideLoading(),e.errCode!==n.Const.success)return i.DifferenceApi.showToast(e.errMsg||"服务器开小差了,请稍后再试"),void(y.isRequest=!1);y.isRequest=!1,i.iniData()}).catch(function(e){t.hideLoading(),y.isRequest=!1,i.DifferenceApi.showToast(e.errMsg||"请求失败")})}}},UpdateCustStatus:function(e){var i=this;y.isRequest||(t.showLoading({title:"操作中"}),y.isRequest=!0,new o.UpdateCustStatus(e).send().then(function(e){if(t.hideLoading(),200!=e.errCode)return i.DifferenceApi.showToast(e.errMsg||"服务器开小差了,请稍后再试"),void(y.isRequest=!1);y.isRequest=!1,i.iniData()}).catch(function(e){y.isRequest=!1,t.hideLoading(),i.DifferenceApi.showToast(e.errMsg||"请求失败")}))},ApplyCustomer:function(e){var i=this;y.isRequest||(t.showLoading({title:"操作中"}),y.isRequest=!0,new o.ApplyNextStep(e).send().then(function(e){if(t.hideLoading(),200!=e.errCode)return y.isRequest=!1,void i.DifferenceApi.showToast(e.errMsg||"服务器开小差了,请稍后再试");y.isRequest=!1,i.iniData()}).catch(function(e){y.isRequest=!1,t.hideLoading(),i.DifferenceApi.showToast(e.errMsg||"请求失败")}))},cancelCeXiao:function(){console.log("取消 撤销认购 页面展示"),this.isShowCheXiaoRenGouView=!1},changeTextArea:function(t){this.cheXiaoRenGouText=t.detail.value},quedinCeXiao:function(){var e=this;if(0!=this.cheXiaoRenGouText.length){var i={cityId:this.detail_info.cityId,custId:this.detail_info.custId,reason:this.cheXiaoRenGouText};t.showLoading({title:"撤销中...",mask:s.Config.mask}),new u.CancelConfirm(i).send().then(function(i){if(t.hideLoading(),i.errCode!==n.Const.success)return Promise.reject(i);e.isShowCheXiaoRenGouView=!1,e.iniData(),e.DifferenceApi.showToast("撤销认购成功")}).catch(function(i){t.hideLoading(),e.DifferenceApi.showToast(i.errMsg||"请求失败")})}else this.DifferenceApi.showToast("请输入撤销原因")},VerifyPhone:function(t){if(!t)return!1;var e=/[*]+/;return!!e.test(t)},goToCallPhoneView:function(t){t?11===t.length?(this.popupType="boDaDianHua",this.popupText.boDaDianHua.content=t,this.$refs.modal.show()):this.DifferenceApi.showToast("电话号码错误"):this.DifferenceApi.showToast("暂无电话")}}};e.default=b}).call(this,i("543d")["default"])},"82aa":function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},a=[];i.d(e,"a",function(){return o}),i.d(e,"b",function(){return a})},"9cf0":function(t,e,i){"use strict";i.r(e);var o=i("82aa"),a=i("fb95");for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);i("1b53");var s=i("2877"),u=Object(s["a"])(a["default"],o["a"],o["b"],!1,null,"029feffc",null);e["default"]=u.exports},a236:function(t,e,i){},bb74:function(t,e,i){"use strict";(function(t){i("d3e9"),i("921b");o(i("66fd"));var e=o(i("9cf0"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},fb95:function(t,e,i){"use strict";i.r(e);var o=i("2a69"),a=i.n(o);for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);e["default"]=a.a}},[["bb74","common/runtime","common/vendor"]]]);